\chapter{OpenState}
A packet entering an OpenFlow switch is processed through a set of linked flow tables that provide matching, forwarding, and packet modification.
We indicate with the term stateless stage the processing operated by a single flow table. Conversely, we define as stateful stage a logical block comprising a State Table and an XFSM table, and implementing our abstraction.
By default all the flow tables are intended as stateless. A new switch capability [\ref{sec:capability}] has been defined in order to support all the OpenState functionalities: flow states [\ref{chap:flow_states}] and global states [\ref{chap:global_states}]. The controller can enable stateful processing for one or more flow table by sending a special control message to the switch [\ref{sec:table_conf}] and by configuring the key extractors (lookup-scope and update-scope). A new state modify message called OFP\_STATE\_MOD has been defined to allow the controller to configure the state entries and key extractors [\ref{sec:msg_set_state}].
Finally two new actions OFPAT\_SET\_STATE [\ref{sec:act_set_state}] and OFPAT\_SET\_FLAGS [\ref{section:set_flag_action}] have been added in order to respectively implement and configure the XFSM state transitions in the flow table and configure the global states.